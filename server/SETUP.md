# 机构登录功能设置说明

## 概述
本系统已实现机构登录验证功能，只有匹配到实际的账号密码才能登录成功，否则会显示登录失败。

## 配置步骤

### 1. 环境配置
在 `server` 目录下创建 `.env` 文件，包含以下配置：

```env
# 数据库配置
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=your_password_here
DB_NAME=brain_monitor

# JWT配置
JWT_SECRET=your_jwt_secret_key_here_make_it_long_and_random
JWT_EXPIRES_IN=24h

# 服务器配置
PORT=3000
NODE_ENV=development
```

### 2. 安装依赖
```bash
cd server
npm install
```

### 3. 初始化数据库
```bash
# 方法1：使用初始化脚本
node scripts/init-db.js

# 方法2：手动执行SQL文件
mysql -u root -p < database/schema.sql
```

### 4. 启动后端服务
```bash
npm start
```

## 测试账号

### 默认机构账号
- **机构ID**: `默认机构`
- **密码**: `123456`

## 功能特性

### 登录验证
- ✅ 必须输入机构ID和密码
- ✅ 验证机构是否存在
- ✅ 验证密码是否正确
- ✅ 显示详细的错误信息
- ✅ 支持密码显示/隐藏切换

### 错误处理
- 机构ID为空：显示"请输入机构ID"
- 密码为空：显示"请输入密码"
- 机构不存在：显示"机构不存在"
- 密码错误：显示"机构密码错误"
- 网络错误：显示"登录失败: [具体错误]"

### 安全特性
- 密码使用bcrypt加密存储
- 支持HTTPS（生产环境）
- 请求频率限制
- 输入验证和清理

## 前端集成

### 错误提示UI
- 红色边框的错误提示框
- 动态显示错误信息
- 登录失败时自动显示

### 用户体验
- 登录按钮状态管理
- 加载状态显示
- 隐私协议验证
- 响应式错误处理

## 测试步骤

1. 启动后端服务
2. 启动前端应用
3. 在机构登录页面输入：
   - 机构ID：`默认机构`
   - 密码：`123456`
4. 点击登录按钮
5. 验证登录成功或失败提示

## 故障排除

### 常见问题
1. **数据库连接失败**
   - 检查MySQL服务是否启动
   - 验证数据库连接配置

2. **登录失败**
   - 确认机构ID和密码正确
   - 检查数据库中的机构数据

3. **网络错误**
   - 确认后端服务已启动
   - 检查端口3000是否被占用

### 日志查看
后端服务会在控制台输出详细的日志信息，包括：
- 数据库连接状态
- 登录请求详情
- 错误信息和堆栈跟踪
